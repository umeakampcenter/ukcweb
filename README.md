# Umeå Kampcenter web
Web site for Umeå Kampcenter, a martial arts academy in Sweden.

## Getting started
These instructions will get you a copy of the project up and running on Windows.

### Prerequisites
Download Xampp with PHP 8+ and MySQL/MariaDB.

Download and install [Git](https://git-scm.com/download/win). Add the PATH to Git (usually C:\Program Files\Git\cmd).

Download the [Composer installer](https://getcomposer.org/download/) (Composer-Setup.exe). Make sure you add the PATH to Composer (usually C:\ProgramData\ComposerSetup\bin).

### Installation
Clone the repository to a folder on your drive using Git. If you are using PHPStorm this can be done by creating a project from Github.

Open up a Git bash console in your project folder and install the project dependencies:
```
composer install
```

Create a `.env` file from the example file and run:
```
php artisan key:generate
```

Install the frontend dependencies and start the build script:
```
npm i
npm run dev
```

Run the migrations and set up the Twill CMS:
```
php artisan twill:update --migrate
```

Seed the database with essential data:
```
php artisan db:seed
```

Create a Twill CMS user:
```
php artisan twill:superadmin <email> <password>
```

Run the built-in PHP web server:
```
php artisan serve --port=8080
```

### Access the application

The web application can be accessed at:
```
http://127.0.0.1:8080/
```

The Twill CMS is at (log in with the user created above):
```
http://127.0.0.1:8080/admin
```

## Project structure

### CMS forms

The navigation in the CMS can be changed here: `routes\twill.php`

The forms for editing a page type are defined in the Twill controllers here: `app\Http\Controllers\Twill`

These are generated by Twill when a new module is created.

The models for the different page types are here: `app\Models`

Form validation logic is located in requests: `app\Http\Requests\Twill`

### Views

The end user facing views are served with the controllers here: `app\Http\Controllers`

Routing is defined here: `routes\web.php`

Page layout/markup are located in blade files here: `resources\views`

### Database

Tables are created with code here: `database\migrations`

New migrations are generated by Twill when a new module is created.

Migrate or rollback with the following commands:
```
php artisan migrate
php artisan migrate:rollback
```

## Workflow

Use the following command to create a new page type/Twill module:
```
php artisan twill:make:module moduleName -T
```